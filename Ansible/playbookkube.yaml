---
- name: Deploy Kubernetes Application
  hosts: appserver  # Replace with your target Kubernetes master host or group
  gather_facts: no  # No need to gather facts for this playbook
  become: yes 
  become_user: root
  
  tasks:
    - name: Copy deployment.yaml to Kubernetes master
      copy:
        src: /var/lib/jenkins/workspace/jenkins-ansible/Ansible/deployment.yaml  # Assuming Jenkins workspace variable
        dest: /home/ec2-user/
      become: yes  # Use sudo for copying if required
      become_user: root  # Use a privileged user for copying if required
      
    - name: Apply Deployment
      ansible.builtin.command: kubectl apply -f /home/ec2-user/deployment.yaml
    
